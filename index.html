<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Birthday Puzzle Quest üß©üéÇ</title>
    <style>
        :root {
            --primary: #ff69b4;
            --secondary: #2a2a2a;
        }

        body {
            background: var(--secondary);
            color: #fff;
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 2rem;
        }

        .puzzle-stage {
            display: none;
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            border: 2px solid var(--primary);
            border-radius: 10px;
        }

        .active-stage {
            display: block;
        }

        .cypher-box {
            background: #1a1a1a;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 3px solid var(--primary);
        }

        #jigsaw-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            max-width: 600px;
            margin: 1rem auto;
        }

        .jigsaw-piece {
            width: 100%;
            height: 150px;
            background-size: cover;
            cursor: pointer;
            opacity: 0.5;
            transition: all 0.3s;
        }

        .jigsaw-piece.correct {
            opacity: 1;
            border: 2px solid var(--primary);
        }

        #timer {
            position: fixed;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .hint {
            color: #888;
            font-size: 0.9rem;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div id="timer">‚è≥ 15:00</div>

    <!-- Stage 0: Initial Cipher -->
    <div class="puzzle-stage active-stage" id="stage0">
        <h2>Stage 1: Memory Cipher</h2>
        <div class="cypher-box">
            <p>Uifsf jt zpvsf hjgu: V Hslg Rw pz Aol Ilhy... Fvb Jylclu?</p>
            <small>Hint: Remember our first date month?</small>
        </div>
        <input type="text" id="cipherAnswer" placeholder="Decrypted message...">
        <button onclick="checkCipher()">Submit</button>
    </div>

    <!-- Stage 1: Jigsaw Puzzle -->
    <div class="puzzle-stage" id="stage1">
        <h2>Stage 2: Rebuild Our Memory</h2>
        <div id="jigsaw-container"></div>
        <div class="hint">Arrange pieces chronologically</div>
    </div>

    <!-- Stage 2: Binary Puzzle -->
    <div class="puzzle-stage" id="stage2">
        <h2>Stage 3: Binary Heart</h2>
        <pre id="binaryCode">
01001000 01100001 01110000 01110000 01111001 
01000010 01101001 01110010 01110100 01101000 
01100100 01100001 01111001 00100001 00100000 
01001101 01111001 00100000 01110011 01100101 
01100011 01110010 01100101 01110100 00100000 
01101001 01110011 00111010 00100000 00110001 
00110001 00110001 00110001 00110001 00110001 
        </pre>
        <input type="number" id="binaryAnswer" placeholder="Decimal code...">
        <button onclick="checkBinary()">Unlock</button>
    </div>

    <!-- Final Stage: Gift Reveal -->
    <div class="puzzle-stage" id="finalStage">
        <h1>üéâ Happy Birthday! üéâ</h1>
        <p id="personalMessage"></p>
        <div id="giftReveal"></div>
    </div>

    <script>
        // =============== CONFIGURATION =============== //
        const CONFIG = {
            // Puzzle 1: Caesar Cipher (offset by first date month)
            CIPHER_OFFSET: 1, // Change to your first date month number
            CIPHER_SOLUTION: "Your gift is... Check stage three! But first:",

            // Puzzle 2: Jigsaw pieces (chronological order)
            JIGSAW_ORDER: [3, 1, 4, 2, 6, 5, 8, 7, 9], // Correct order indexes
            IMAGE_URLS: [
                "IMG_URL_1",  // Replace with actual image URLs
                "IMG_URL_2",
                // ... Add 7 more image URLs
            ],

            // Puzzle 3: Binary message
            BINARY_SECRET: 11111, // Change to meaningful number
            FINAL_MESSAGE: "Your real gift is... [INSERT REAL GIFT DETAILS]",
            PERSONAL_NOTE: "Happy birthday my love! Thanks for solving my puzzles. You're my ultimate partner in crime. I love you! ‚ù§Ô∏è"
        };

        // =============== GAME STATE =============== //
        let currentStage = 0;
        let timeLeft = 900; // 15 minutes in seconds

        // =============== PUZZLE LOGIC =============== //
        // Stage 0: Caesar Cipher Decoder
        function caesarDecrypt(text, shift) {
            return text.replace(/[a-z]/gi, c => {
                const base = c < 'a' ? 65 : 97;
                return String.fromCharCode((c.charCodeAt(0) - base - shift + 26) % 26 + base);
            });
        }

        function checkCipher() {
            const answer = document.getElementById('cipherAnswer').value.toLowerCase();
            const decrypted = caesarDecrypt("Uifsf jt zpvsf hjgu: V Hslg Rw pz Aol Ilhy... Fvb Jylclu?", CONFIG.CIPHER_OFFSET);
            
            if(answer.includes("your gift")) {
                loadStage(1);
                initializeJigsaw();
            }
        }

        // Stage 1: Jigsaw Puzzle
        function initializeJigsaw() {
            const container = document.getElementById('jigsaw-container');
            CONFIG.IMAGE_URLS.forEach((url, index) => {
                const piece = document.createElement('div');
                piece.className = 'jigsaw-piece';
                piece.style.backgroundImage = `url(${url})`;
                piece.dataset.index = index + 1;
                piece.onclick = () => checkJigsawOrder(piece);
                container.appendChild(piece);
            });
        }

        function checkJigsawOrder(element) {
            const currentIndex = Array.from(element.parentNode.children).indexOf(element);
            const correctIndex = CONFIG.JIGSAW_ORDER[currentIndex] - 1;
            
            if(parseInt(element.dataset.index) === correctIndex) {
                element.classList.add('correct');
                checkJigsawComplete();
            }
        }

        function checkJigsawComplete() {
            const correct = document.querySelectorAll('.correct').length;
            if(correct === 9) loadStage(2);
        }

        // Stage 2: Binary Decoder
        function checkBinary() {
            const answer = parseInt(document.getElementById('binaryAnswer').value);
            if(answer === CONFIG.BINARY_SECRET) {
                document.getElementById('personalMessage').textContent = CONFIG.PERSONAL_NOTE;
                document.getElementById('giftReveal').innerHTML = `
                    <h3>${CONFIG.FINAL_MESSAGE}</h3>
                    <p>Your confirmation code: ${btoa("LoveYouForever")}</p>
                `;
                loadStage(3);
            }
        }

        // =============== GAME CONTROLS =============== //
        function loadStage(stageNumber) {
            document.querySelector('.active-stage').classList.remove('active-stage');
            document.getElementById(`stage${stageNumber}`).classList.add('active-stage');
            currentStage = stageNumber;
        }

        // Timer system
        setInterval(() => {
            timeLeft--;
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = 
                `‚è≥ ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if(timeLeft <= 0) {
                alert("Time's up! Refresh to try again ‚ù§Ô∏è");
                location.reload();
            }
        }, 1000);

        // Initialize security
        const password = prompt("Enter birthday password:");
        if(password !== "HER_NAME_123") { // Change password
            alert("Invalid access! ‚ùå");
            window.close();
        }
    </script>
</body>
</html>
